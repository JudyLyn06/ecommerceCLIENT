{"ast":null,"code":"var _jsxFileName = \"/Users/admin/Documents/Zuitt/Courses/wdc028v1.5b/fullstack/csp3FullStack/csp3FrontEnd/src/pages/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext } from 'react';\nimport { Form, Button, Card, Row, Col } from 'react-bootstrap';\nimport { Link, Redirect, useHistory } from 'react-router-dom';\nimport UserContext from '../UserContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function LoginForm(props) {\n  _s();\n\n  const history = useHistory();\n  const {\n    user,\n    setUser\n  } = useContext(UserContext);\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [willRedirect, setWillRedirect] = useState(false);\n\n  const authenticate = e => {\n    e.preventDefault();\n    fetch(`${process.env.REACT_APP_API_URL}/users/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        email: email,\n        password: password\n      })\n    }).then(res => res.json()).then(data => {\n      if (typeof data.access !== 'undefined') {\n        localStorage.setItem('token', data.access);\n        retrieveUserDetails(data.access);\n      } else {\n        alert(\"Authentication failed. Please check your login details and try again.\");\n      }\n    });\n  };\n\n  const retrieveUserDetails = token => {\n    fetch(`${process.env.REACT_APP_API_URL}/users/details`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => res.json()).then(data => {\n      setUser({\n        id: data._id,\n        isAdmin: data.isAdmin\n      });\n\n      if (data.isAdmin === true) {\n        setWillRedirect(true);\n      } else {\n        if (props.location.state.from === 'cart') {\n          history.goBack();\n        } else {\n          setWillRedirect(true);\n        }\n      }\n    });\n  };\n\n  return willRedirect === true ? user.isAdmin === true ? /*#__PURE__*/_jsxDEV(Redirect, {\n    to: \"/products\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 17\n  }, this) : /*#__PURE__*/_jsxDEV(Redirect, {\n    to: \"/\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 17\n  }, this) : /*#__PURE__*/_jsxDEV(Row, {\n    className: \"justify-content-center\",\n    children: /*#__PURE__*/_jsxDEV(Col, {\n      xs: true,\n      md: \"6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-center my-4\",\n        children: \"Log In\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Card, {\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          onSubmit: e => authenticate(e),\n          children: [/*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n              controlId: \"userEmail\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"Email:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 77,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"email\",\n                placeholder: \"Enter your email\",\n                value: email,\n                onChange: e => setEmail(e.target.value),\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 78,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n              controlId: \"password\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"Password:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 88,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"password\",\n                placeholder: \"Enter your password\",\n                value: password,\n                onChange: e => setPassword(e.target.value),\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Card.Footer, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-grid gap-2\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"primary\",\n                type: \"submit\",\n                block: true,\n                children: \"Submit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-center mt-3\",\n        children: [\"Don't have an account yet? \", /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/register\",\n          children: \"Click here\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 52\n        }, this), \" to register.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 13\n  }, this);\n}\n\n_s(LoginForm, \"klQ7dffEL4F53yG6eJX6S910QZU=\", false, function () {\n  return [useHistory];\n});\n\n_c = LoginForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"names":["React","useState","useContext","Form","Button","Card","Row","Col","Link","Redirect","useHistory","UserContext","LoginForm","props","history","user","setUser","email","setEmail","password","setPassword","willRedirect","setWillRedirect","authenticate","e","preventDefault","fetch","process","env","REACT_APP_API_URL","method","headers","body","JSON","stringify","then","res","json","data","access","localStorage","setItem","retrieveUserDetails","alert","token","Authorization","id","_id","isAdmin","location","state","from","goBack","target","value"],"sources":["/Users/admin/Documents/Zuitt/Courses/wdc028v1.5b/fullstack/csp3FullStack/csp3FrontEnd/src/pages/Login.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\nimport { Form, Button, Card, Row, Col } from 'react-bootstrap';\nimport { Link, Redirect, useHistory } from 'react-router-dom';\n\nimport UserContext from '../UserContext';\n\nexport default function LoginForm(props){\n\n    const history = useHistory();\n    const { user, setUser } = useContext(UserContext);\n\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [willRedirect, setWillRedirect] = useState(false);\n\n    const authenticate = (e) => {\n\n        e.preventDefault();\n\n        fetch(`${ process.env.REACT_APP_API_URL }/users/login`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                email: email,\n                password: password\n            })\n        })\n        .then(res => res.json())\n        .then(data => {\n\n            if (typeof data.access !== 'undefined') {\n                localStorage.setItem('token', data.access);\n                retrieveUserDetails(data.access);\n            } else {\n                alert(\"Authentication failed. Please check your login details and try again.\");\n            }\n\n        })\n    }\n    \n    const retrieveUserDetails = (token) => {\n\n        fetch(`${process.env.REACT_APP_API_URL}/users/details`, {\n            headers: { Authorization: `Bearer ${ token }`}\n        })\n        .then(res => res.json())\n        .then(data => {\n\n            setUser({ id: data._id, isAdmin: data.isAdmin });\n\n            if (data.isAdmin === true) {\n                setWillRedirect(true);\n            } else {\n                if (props.location.state.from === 'cart') {\n                    history.goBack();\n                } else {\n                    setWillRedirect(true);\n                }\n            }\n        })\n    }\n\n    return(\n        willRedirect === true ?\n            user.isAdmin === true ?\n                <Redirect to='/products'/>\n            :\n                <Redirect to='/'/>\n        :\n            <Row className=\"justify-content-center\">\n                <Col xs md=\"6\">\n                    <h2 className=\"text-center my-4\">Log In</h2>\n                    <Card>\n                        <Form onSubmit={e => authenticate(e)}>\n                            <Card.Body>\n                                <Form.Group controlId=\"userEmail\">\n                                    <Form.Label>Email:</Form.Label>\n                                    <Form.Control\n                                        type=\"email\"\n                                        placeholder=\"Enter your email\"\n                                        value={email}\n                                        onChange={e => setEmail(e.target.value)}\n                                        required\n                                    />\n                                </Form.Group>\n\n                                <Form.Group controlId=\"password\">\n                                    <Form.Label>Password:</Form.Label>\n                                    <Form.Control\n                                        type=\"password\"\n                                        placeholder=\"Enter your password\"\n                                        value={password}\n                                        onChange={e => setPassword(e.target.value)}\n                                        required\n                                    />\n                                </Form.Group>\n\n                            </Card.Body>\n                            <Card.Footer>\n                                <div className=\"d-grid gap-2\">\n                                    <Button variant=\"primary\" type=\"submit\" block>\n                                        Submit\n                                    </Button>\n                                </div>\n                            </Card.Footer>\n                        </Form>\n                    </Card>\n                    <p className=\"text-center mt-3\">\n                        Don't have an account yet? <Link to=\"/register\">Click here</Link> to register.\n                    </p>\n                </Col>              \n            </Row>\n    );\n    \n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}